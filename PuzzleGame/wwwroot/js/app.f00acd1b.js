(function(){"use strict";var e={3667:function(e,t,o){var s=o(6369),n=function(){var e=this,t=e._self._c;return t("div",{attrs:{id:"app"}},[t("div",{directives:[{name:"show",rawName:"v-show",value:e.isGameStartScreenShown,expression:"isGameStartScreenShown"}],staticStyle:{"z-index":"2"},attrs:{id:"start-game-screen"}},[t("button",{on:{click:e.startGame}},[e._v("Start Game")])]),t("add-score-form",{directives:[{name:"show",rawName:"v-show",value:e.isAddScoreFormShown,expression:"isAddScoreFormShown"}],staticStyle:{"z-index":"2"},attrs:{gameTimeSeconds:e.gameTimeSeconds,movesCount:e.movesCount,quitForm:e.onQuitAddScoreForm}}),t("game-scores",{directives:[{name:"show",rawName:"v-show",value:e.isScoresInfoShown,expression:"isScoresInfoShown"}],ref:"scores",staticStyle:{"z-index":"2"},attrs:{quitScores:e.onQuitScores}}),t("div",{directives:[{name:"show",rawName:"v-show",value:e.isBlurScreenShown,expression:"isBlurScreenShown"}],staticStyle:{"z-index":"1"},attrs:{id:"blur-screen"}}),t("puzzle-game",{ref:"game",staticStyle:{"z-index":"0"},attrs:{gameOver:e.onGameOver}})],1)},i=[],r=function(){var e=this,t=e._self._c;return t("div",[t("div",{attrs:{id:"pieces-container"}},e._l(e.pieces,(function(o,s){return t("div",{staticClass:"piece",style:{left:25*o.x+"%",top:25*o.y+"%"},on:{click:function(t){return e.movePiece(o)}}},[t("img",{attrs:{src:`${e.base_pieces_path}piece_${s+1}.jpg`}})])})),0)])},c=[],a=(o(7658),{props:["gameOver"],data:function(){return{base_pieces_path:({NODE_ENV:"production",BASE_URL:"/"}.VUE_APP_WEB_API??"")+"static/pieces/",pieces:null,empty_cell:null,isGameOn:!1,startTime:null,movesCount:0}},methods:{isPuzzleSolved:function(){for(let e of this.pieces)if(e.x+4*e.y!=e.index)return!1;return!0},isPuzzleSolvable:function(){const e=this.pieces.map((e=>e.x+4*e.y));let t=!0;for(let o=0;o<14;o++)for(let s=o+1;s<15;s++)e[o]>e[s]&&(t=!t);return t},placePieces:function(){this.pieces=[];for(let e=0;e<4;e++)for(let t=0;t<(3==e?3:4);t++)this.pieces.push({index:t+4*e,x:t,y:e});this.empty_cell={x:3,y:3}},shufflePieces:function(){for(let e=14;e>0;e--){let t=Math.floor(Math.random()*(e+1)),o={x:this.pieces[e].x,y:this.pieces[e].y};this.pieces[e].x=this.pieces[t].x,this.pieces[e].y=this.pieces[t].y,this.pieces[t].x=o.x,this.pieces[t].y=o.y}},movePiece:function(e){if(this.isGameOn&&Math.abs(e.x-this.empty_cell.x)+Math.abs(e.y-this.empty_cell.y)==1){let t={x:e.x,y:e.y};e.x=this.empty_cell.x,e.y=this.empty_cell.y,this.empty_cell.x=t.x,this.empty_cell.y=t.y,this.movesCount++,this.isPuzzleSolved()&&this.endGame()}},startGame:function(){this.placePieces(),setTimeout((()=>{while(1)if(this.shufflePieces(),!this.isPuzzleSolved()&&this.isPuzzleSolvable()){this.isGameOn=!0,this.movesCount=0,this.startTime=Date.now();break}}),2e3)},endGame:function(){this.isGameOn=!1;const e=Math.floor((Date.now()-this.startTime)/1e3);this.gameOver(e,this.movesCount)}}}),u=a,l=o(1001),m=(0,l.Z)(u,r,c,!1,null,"eae542e4",null),h=m.exports,d=function(){var e=this,t=e._self._c;return t("div",[t("div",{attrs:{id:"form-container"}},[t("div",[t("h1",[e._v("Scores:")]),t("p",[t("b",[e._v("Total time spent - "+e._s(e.secondsToTime(e.gameTimeSeconds)))])]),t("p",[t("b",[e._v("Total moves made - "+e._s(e.movesCount))])])]),t("div",{attrs:{id:"form-block"}},[t("input",{directives:[{name:"model",rawName:"v-model",value:e.name,expression:"name"}],attrs:{type:"text",placeholder:"Name"},domProps:{value:e.name},on:{input:function(t){t.target.composing||(e.name=t.target.value)}}}),t("button",{on:{"~click":function(t){return e.addScore.apply(null,arguments)}}},[e._v("Submit")])])])])},p=[],S={props:["gameTimeSeconds","movesCount","quitForm"],data:function(){return{name:""}},methods:{addScore:async function(){console.log("addScore"),await fetch(({NODE_ENV:"production",BASE_URL:"/"}.VUE_APP_WEB_API??"")+"api/score",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({Name:this.name,TimeSeconds:this.gameTimeSeconds,MovesAmount:this.movesCount})}).catch((e=>console.error("Failed to add score",e))),this.quitForm(this.name)}}},v=S,f=(0,l.Z)(v,d,p,!1,null,"1ede9111",null),_=f.exports,w=function(){var e=this,t=e._self._c;return t("div",[t("div",{attrs:{id:"scores-container"}},[t("div",{attrs:{id:"scores"}},[t("game-score",{directives:[{name:"show",rawName:"v-show",value:e.isMyScoresShown,expression:"isMyScoresShown"}],attrs:{id:"my-scores",title:`Scores by time of player ${e.user_name}`,scores:e.user_scores,isNameColumnHidden:!0}}),t("game-score",{directives:[{name:"show",rawName:"v-show",value:e.isTopScoresShown,expression:"isTopScoresShown"}],attrs:{id:"top-scores",title:`Top ${e.top} scores by time`,scores:e.top_scores}})],1),t("div",[t("button",{on:{click:e.switchShownScores}},[e._v("Switch Scores")]),t("button",{on:{click:e.quitScores}},[e._v("Quit")])])])])},y=[],x=function(){var e=this,t=e._self._c;return t("div",[t("table",[t("caption",[t("b",[e._v(e._s(e.title))])]),t("thead",[t("tr",[t("th"),t("th",{directives:[{name:"show",rawName:"v-show",value:!e.isNameColumnHidden,expression:"!isNameColumnHidden"}]},[e._v("Name")]),t("th",[e._v("Time")]),t("th",[e._v("Moves")])])]),t("tbody",e._l(e.scores,(function(o,s){return t("tr",[t("td",[e._v(e._s(s+1))]),t("td",{directives:[{name:"show",rawName:"v-show",value:!e.isNameColumnHidden,expression:"!isNameColumnHidden"}]},[e._v(e._s(o.name))]),t("td",[e._v(e._s(o.time))]),t("td",[e._v(e._s(o.moves))])])})),0)])])},b=[],g={props:["title","scores","isNameColumnHidden"]},T=g,O=(0,l.Z)(T,x,b,!1,null,"62ac7410",null),P=O.exports,N={props:["quitScores"],components:{GameScore:P},data:function(){return{user_name:null,top:10,top_scores:null,user_scores:null,isMyScoresShown:!0,isTopScoresShown:!1}},methods:{mapDTO:function(e){return{name:e.name,time:this.secondsToTime(e.timeSeconds),moves:e.movesAmount}},loadScores:function(e){this.user_name=e;const t={NODE_ENV:"production",BASE_URL:"/"}.VUE_APP_WEB_API??"";fetch(t+"api/score/top/"+this.top).then((e=>e.json())).then((e=>this.top_scores=e.map(this.mapDTO))),fetch(t+"api/score/"+e).then((e=>e.json())).then((e=>this.user_scores=e.map(this.mapDTO)))},switchShownScores:function(){this.isMyScoresShown=!this.isMyScoresShown,this.isTopScoresShown=!this.isTopScoresShown}}},z=N,C=(0,l.Z)(z,w,y,!1,null,"11ceab1e",null),G=C.exports,A={name:"app",components:{PuzzleGame:h,AddScoreForm:_,GameScores:G},data:function(){return{isGameStartScreenShown:!0,isBlurScreenShown:!0,isAddScoreFormShown:!1,isScoresInfoShown:!1,gameTimeSeconds:null,movesCount:null}},methods:{startGame:function(){this.isGameStartScreenShown=!1,this.isBlurScreenShown=!1,this.$refs.game.startGame()},onGameOver:function(e,t){this.isBlurScreenShown=!0,this.isAddScoreFormShown=!0,this.gameTimeSeconds=e,this.movesCount=t},onQuitAddScoreForm:function(e){this.isAddScoreFormShown=!1,this.isScoresInfoShown=!0,this.$refs.scores.loadScores(e)},onQuitScores:function(){this.isScoresInfoShown=!1,this.isGameStartScreenShown=!0}}},E=A,M=(0,l.Z)(E,n,i,!1,null,null,null),F=M.exports;s.ZP.config.productionTip=!1,s.ZP.prototype.secondsToTime=e=>{const t=Math.floor(e/3600);e%=3600;const o=Math.floor(e/60);return e%=60,`${t}:${o}:${e}`},new s.ZP({render:e=>e(F)}).$mount("#app")}},t={};function o(s){var n=t[s];if(void 0!==n)return n.exports;var i=t[s]={exports:{}};return e[s].call(i.exports,i,i.exports,o),i.exports}o.m=e,function(){var e=[];o.O=function(t,s,n,i){if(!s){var r=1/0;for(l=0;l<e.length;l++){s=e[l][0],n=e[l][1],i=e[l][2];for(var c=!0,a=0;a<s.length;a++)(!1&i||r>=i)&&Object.keys(o.O).every((function(e){return o.O[e](s[a])}))?s.splice(a--,1):(c=!1,i<r&&(r=i));if(c){e.splice(l--,1);var u=n();void 0!==u&&(t=u)}}return t}i=i||0;for(var l=e.length;l>0&&e[l-1][2]>i;l--)e[l]=e[l-1];e[l]=[s,n,i]}}(),function(){o.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return o.d(t,{a:t}),t}}(),function(){o.d=function(e,t){for(var s in t)o.o(t,s)&&!o.o(e,s)&&Object.defineProperty(e,s,{enumerable:!0,get:t[s]})}}(),function(){o.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){var e={143:0};o.O.j=function(t){return 0===e[t]};var t=function(t,s){var n,i,r=s[0],c=s[1],a=s[2],u=0;if(r.some((function(t){return 0!==e[t]}))){for(n in c)o.o(c,n)&&(o.m[n]=c[n]);if(a)var l=a(o)}for(t&&t(s);u<r.length;u++)i=r[u],o.o(e,i)&&e[i]&&e[i][0](),e[i]=0;return o.O(l)},s=self["webpackChunkpuzzle_game"]=self["webpackChunkpuzzle_game"]||[];s.forEach(t.bind(null,0)),s.push=t.bind(null,s.push.bind(s))}();var s=o.O(void 0,[998],(function(){return o(3667)}));s=o.O(s)})();
//# sourceMappingURL=app.f00acd1b.js.map